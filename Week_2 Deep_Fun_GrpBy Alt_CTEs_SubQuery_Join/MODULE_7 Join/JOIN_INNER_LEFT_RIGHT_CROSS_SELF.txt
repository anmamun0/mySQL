SELECT *
FROM EMPLOYEES;

SELECT FIRST_NAME ,
	(SELECT DEPARTMENT_NAME 
    FROM DEPARTMENTS
    WHERE EMPLOYEES.DEPARTMENT_ID = DEPARTMENT_ID) AS DEPARTMENT_NAME
FROM EMPLOYEES;

SELECT EMPLOYEES.FIRST_NAME, DEPARTMENTS.DEPARTMENT_NAME
FROM EMPLOYEES, DEPARTMENTS
WHERE EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


SELECT EMPLOYEES.FIRST_NAME, DEPARTMENTS.DEPARTMENT_NAME
FROM EMPLOYEES JOIN DEPARTMENTS ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;

SELECT EMPLOYEES.FIRST_NAME, DEPARTMENTS.DEPARTMENT_NAME
FROM EMPLOYEES JOIN DEPARTMENTS USING(DEPARTMENT_ID);

-- -------------------------------- --

SELECT *FROM EMPLOYEES;


SELECT FIRST_NAME,
		(SELECT FIRST_NAME
        FROM EMPLOYEES AS B
        WHERE EMPLOYEES.MANAGER_ID = B.EMPLOYEE_ID) AS BOSS
FROM EMPLOYEES;
 

SELECT mng.FIRST_NAME AS EMP , emp.FIRST_NAME
FROM EMPLOYEES AS emp
	JOIN EMPLOYEES AS mng
    ON emp.EMPLOYEE_ID = mng.MANAGER_ID;

SELECT  EMP.FIRST_NAME AS EM , MGR.FIRST_NAME AS MANGER 
FROM EMPLOYEES AS MGR
JOIN EMPLOYEES AS EMP
ON EMP.MANAGER_ID = MGR.EMPLOYEE_ID;

-- --------------------- --

SELECT DEPARTMENTS.DEPARTMENT_NAME
FROM DEPARTMENTS
LEFT JOIN EMPLOYEES
ON DEPARTMENTS.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID
WHERE EMPLOYEES.DEPARTMENT_ID IS NULL;


SELECT EMP.FIRST_NAME , MGR.SALARY, AVG()
FROM EMPLOYEES AS EMP
JOIN DEPARTMENTS AS MGR
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID;


SELECT FIRST_NAME,
		SALARY,
        (SELECT AVG(B.SALARY) FROM EMPLOYEES AS B
			WHERE B.DEPARTMENT_ID = EM.DEPARTMENT_ID
            ) - EM.SALARY
FROM EMPLOYEES AS EM;









SELECT AVG(SALARY) - (SELECT SALARY FROM EMPLOYEES WHERE EMPLOYEE_ID = 103)
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 60;



SELECT EMPLOYEES.FIRST_NAME, EMPLOYEE_ID, EMPLOYEES.SALARY,
       (SELECT AVG(SALARY) FROM EMPLOYEES 
       WHERE DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID) - EMPLOYEES.SALARY
FROM EMPLOYEES
JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID 
ORDER BY FIRST_NAME ASC;
	
    
    
SELECT FIRST_NAME, EMPLOYEE_ID , 
		DEPARTMENT_ID, SALARY,
		(SELECT AVG(SALARY) FROM EMPLOYEES AS E WHERE E.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID) AS AVG_SAL,
        (SELECT AVG(SALARY) FROM EMPLOYEES AS E WHERE E.DEPARTMENT_ID = EMPLOYEES.DEPARTMENT_ID) - SALARY AS HOW_MINI
FROM EMPLOYEES
WHERE FIRST_NAME = 'ALEXANDER';

SELECT AVG(SALARY)
FROM EMPLOYEES
WHERE DEPARTMENT_ID = 30;


SELECT DEPARTMENT_NAME
FROM EMPLOYEES
JOIN DEPARTMENTS
ON EMPLOYEES.DEPARTMENT_ID = DEPARTMENTS.DEPARTMENT_ID
GROUP BY DEPARTMENT_NAME
HAVING MIN(SALARY) > 5000;
 
  







