SELECT *
FROM EMPLOYEES;

-- 1ST HEIGHT SALARY WHO 

 -- 1ST WAY
SELECT * 
FROM EMPLOYEES 
WHERE SALARY = (
		SELECT MAX(SALARY)
		FROM EMPLOYEES
		);

 -- Table expression way
WITH MAXI AS
(
	SELECT MAX(SALARY) AS SELL1
    FROM EMPLOYEES
)
SELECT *
FROM EMPLOYEES
WHERE SALARY = (
			SELECT SELL1
            FROM MAXI
			);

-- SECOND HIGEST SALARY

SELECT MAX(SALARY)
FROM EMPLOYEES
WHERE SALARY < (SELECT MAX(SALARY)
				FROM EMPLOYEES);
                
SELECT *
FROM EMPLOYEES
WHERE SALARY = (
				SELECT MAX(SALARY)
				FROM EMPLOYEES
				WHERE SALARY < (SELECT MAX(SALARY)
								FROM EMPLOYEES)
);

-- 2ND WAY TABLE EXPRESSION

WITH MAXI1 AS
(
	SELECT MAX(SALARY) MAXI1_SHELL
    FROM EMPLOYEES
),
MAXI2 AS
(
	SELECT MAX(SALARY) MAXI2_SHELL
    FROM EMPLOYEES
    WHERE SALARY < (SELECT MAXI1_SHELL FROM MAXI1)
)
SELECT *
FROM EMPLOYEES
WHERE SALARY = ( SELECT MAXI2_SHELL FROM MAXI2);



-- 3RD HIGEST SALARY -

WITH MAXI1 AS
(
	SELECT MAX(SALARY) AS A
    FROM EMPLOYEES
),
MAXI2 AS
(
	SELECT MAX(SALARY) AS B
    FROM EMPLOYEES
    WHERE SALARY < (SELECT A FROM MAXI1)
),
MAXI3 AS
(
	SELECT MAX(SALARY) AS C
    FROM EMPLOYEES
    WHERE SALARY < (SELECT B FROM MAXI2)
)
SELECT *
FROM EMPLOYEES 
WHERE SALARY = ( SELECT C FROM MAXI3);

-- 3RD LOWEST SALARY

WITH MINI1 AS
(
	SELECT MIN(SALARY) AS A
    FROM EMPLOYEES
),
MINI2 AS 
(
	SELECT MIN(SALARY) AS B
    FROM EMPLOYEES 
    WHERE SALARY > (SELECT A FROM MINI1)
),
MINI3 AS
(
	SELECT MIN(SALARY) AS C
    FROM EMPLOYEES
    WHERE SALARY > (SELECT B FROM MINI2)
)

SELECT *
FROM EMPLOYEES
WHERE SALARY = (SELECT C FROM MINI3);


SELECT DISTINCT SALARY
FROM EMPLOYEES
ORDER BY SALARY ASC;

-- -------------------------------------- --

WITH STORE AS
(
	SELECT HIRE_DATE AS STEVEN_HIRE
	FROM EMPLOYEES 
	WHERE FIRST_NAME = 'STEVEN'
	ORDER BY HIRE_DATE DESC
	LIMIT 1
)
SELECT *
FROM EMPLOYEES
WHERE HIRE_DATE > (SELECT STEVEN_HIRE FROM STORE);
